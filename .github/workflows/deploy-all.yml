# Deploy both Web and API to Azure. Runs on push to main (any path) or manual dispatch.
# Uses the same secrets/variables as deploy-web.yml and deploy-api.yml.

name: Deploy All (Web + API)

on:
  push:
    branches: [main]
  workflow_dispatch:

# Avoid overlapping deploys when multiple pushes happen quickly
concurrency:
  group: deploy-all-${{ github.ref }}
  cancel-in-progress: false

jobs:
  deploy-web:
    uses: ./.github/workflows/deploy-web.yml
    secrets: inherit

  deploy-api:
    uses: ./.github/workflows/deploy-api.yml
    secrets: inherit
